source("erlang.R")

con <- textConnection("  R0  ell lamm.anal lamm.num lamp.anal lamp.num
1 1.3 0.63 0.28533 0.74445 -0.26981 -0.26974
2 1.6 0.57 0.53303 1.21074 -0.48652 -0.4865
3 1.8 0.44 0.68622 1.20354 -0.61141 -0.61139
4 2.2 0.24 1.01421 1.31784 -0.76291 -0.76287
5 3 0.21 1.58482 1.98203 -0.98146 -0.98137
6 4.5 0.23 2.4437 3.12894 -1.20415 -1.20392
7 4.5 0.68 2.32501 6.9247 -1.33541 -1.33512
8 4.5 0.83 2.56961 13.70916 -1.12638 -1.12573
9 5.5 0.079 3.57258 3.84299 -1.05855 -1.05756
10 6 0.11 3.67733 4.08737 -1.1043 -1.10357
11 6.5 0.59 3.13052 7.30994 -1.64367 -1.63313
12 6.8 0.29 3.40873 4.70779 -1.39046 -1.39006
13 11 0.67 4.83417 13.57315 -1.492 -1.48798
14 12 0.71 5.27399 16.55738 -1.40828 -1.40686
15 17 0.36 6.4414 9.70464 -1.5625 -1.54052
16 17 0.62 6.38776 15.52176 -1.6129 -1.57477
")
tt <- read.table(con)
close(con)

ll.num <-
suppressWarnings(classes = "zeroReplacedWarning",
t(mapply(function(R0, ell)
             erlang(to = 256, by = 1/8, R0 = R0, ell = ell)$rate,
         R0 = tt$R0, ell = tt$ell))
)

ll.anal <-
cbind(tt$lamm.anal, tt$lamp.anal)

abs(ll.num/ll.anal - 1) # rel. err.
all.equal(ll.num, ll.anal, tolerance = 1e-3)
